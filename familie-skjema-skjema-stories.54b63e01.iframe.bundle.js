(self.webpackChunkfamilie_felles_frontend=self.webpackChunkfamilie_felles_frontend||[]).push([[928],{"./packages/familie-skjema/skjema.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EnkeltSkjema:()=>EnkeltSkjema,__namedExportsOrder:()=>__namedExportsOrder,default:()=>skjema_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js");const hashid=new(__webpack_require__("./node_modules/hashids/esm/hashids.js").A);function s4(){return Math.floor(65536*(1+Math.random())).toString().substring(1)}var deep_equal=__webpack_require__("./node_modules/deep-equal/index.js"),deep_equal_default=__webpack_require__.n(deep_equal),Valideringsstatus=function(Valideringsstatus){return Valideringsstatus.FEIL="FEIL",Valideringsstatus.ADVARSEL="ADVARSEL",Valideringsstatus.OK="OK",Valideringsstatus.IKKE_VALIDERT="IKKE_VALIDERT",Valideringsstatus}({});const defaultValidator=felt=>({...felt,valideringsstatus:"OK"}),useFelt=({avhengigheter={},feltId,skalFeltetVises,valideringsfunksjon=defaultValidator,verdi,nullstillVedAvhengighetEndring=!0})=>{const[id]=(0,react.useState)(feltId||function genererId(){return hashid.encode([s4(),s4()])}()),initialFeltState={feilmelding:"",valider:valideringsfunksjon,valideringsstatus:Valideringsstatus.IKKE_VALIDERT,verdi},[feltState,settFeltState]=(0,react.useState)(initialFeltState),[erSynlig,settErSynlig]=(0,react.useState)(!skalFeltetVises||skalFeltetVises(avhengigheter)),nullstill=()=>{settFeltState(initialFeltState)},validerOgSettFelt=(verdi=feltState.verdi)=>{const validertFelt=feltState.valider({...feltState,verdi},avhengigheter);return deep_equal_default()(feltState,validertFelt)||settFeltState(validertFelt),validertFelt};(0,react.useEffect)(()=>{skalFeltetVises?(nullstillVedAvhengighetEndring&&feltState.valideringsstatus!==Valideringsstatus.IKKE_VALIDERT&&nullstill(),settErSynlig(skalFeltetVises(avhengigheter))):validerOgSettFelt()},[...avhengigheter?Object.values(avhengigheter).reduce((acc,avhengighet)=>avhengighet instanceof Object&&"valideringsstatus"in avhengighet?[...acc,avhengighet.verdi]:[...acc,avhengighet],[]):[]]);const onChange=(0,react.useCallback)(verdi=>{const normalisertVerdi=function isChangeEvent(value){return"object"==typeof value&&null!==value&&Reflect.has(value,"target")&&Reflect.has(value.target,"value")}(verdi)?verdi.target.value:verdi;validerOgSettFelt(normalisertVerdi)},[validerOgSettFelt,settFeltState]),hentNavInputProps=(0,react.useCallback)(visFeilmelding=>({feil:visFeilmelding?feltState.feilmelding:void 0,error:visFeilmelding?feltState.feilmelding:void 0,id,onChange,value:feltState.verdi}),[validerOgSettFelt,settFeltState]),hentNavBaseSkjemaProps=(0,react.useCallback)(visFeilmelding=>({feil:visFeilmelding?feltState.feilmelding:void 0,error:visFeilmelding?feltState.feilmelding:void 0,id,value:feltState.verdi}),[validerOgSettFelt,settFeltState]);return(0,react.useMemo)(()=>({...feltState,id,hentNavInputProps,hentNavBaseSkjemaProps,nullstill,erSynlig,onChange,validerOgSettFelt}),[feltState,hentNavInputProps,validerOgSettFelt,nullstill,onChange])};var dist=__webpack_require__("./packages/familie-typer/dist/index.js");__webpack_require__("./node_modules/axios/lib/axios.js").A.defaults.baseURL=window.location.origin;const HttpContext=(0,react.createContext)(void 0);const useSkjema=({felter,skjemanavn})=>{const{request}=function useHttp(){const context=(0,react.useContext)(HttpContext);if(void 0===context)throw new Error("useHttp må brukes innenfor HttpProvider");return context}(),[visFeilmeldinger,settVisfeilmeldinger]=(0,react.useState)(!1),[submitRessurs,settSubmitRessurs]=(0,react.useState)((0,dist.Nh)()),alleSynligeFelter=()=>Object.values(felter).filter(felt=>felt.erSynlig),validerAlleSynligeFelter=()=>{const synligeFelter=alleSynligeFelter().map(felt=>felt);return[...synligeFelter.filter(unknownFelt=>unknownFelt.valideringsstatus===Valideringsstatus.IKKE_VALIDERT).map(unknownFelt=>unknownFelt.validerOgSettFelt(unknownFelt.verdi,{felter})),...synligeFelter.filter(unknownFelt=>unknownFelt.valideringsstatus!==Valideringsstatus.IKKE_VALIDERT)]},kanSendeSkjema=()=>{const validerteSynligeFelter=validerAlleSynligeFelter();return settVisfeilmeldinger(!0),0===validerteSynligeFelter.filter(felt=>felt.valideringsstatus!==Valideringsstatus.OK).length&&skjema.submitRessurs.status!==dist.WG.HENTER},nullstillSkjema=()=>{alleSynligeFelter().forEach(felt=>felt.nullstill()),settVisfeilmeldinger(!1)},skjema={felter,visFeilmeldinger,skjemanavn,submitRessurs};return{hentFeilTilOppsummering:()=>Object.values(alleSynligeFelter()).filter(felt=>felt.valideringsstatus===Valideringsstatus.FEIL).map(felt=>{const typetFelt=felt;return{skjemaelementId:typetFelt.id,feilmelding:"string"==typeof typetFelt.feilmelding?typetFelt.feilmelding:""}}),kanSendeSkjema,nullstillSkjema,onSubmit:(familieAxiosRequestConfig,onSuccess,onError)=>{kanSendeSkjema()&&(settSubmitRessurs((0,dist.bb)()),request(familieAxiosRequestConfig).then(response=>{settSubmitRessurs(response),response.status===dist.WG.SUKSESS?(nullstillSkjema(),onSuccess(response)):onError&&onError(response)}))},settSubmitRessurs,settVisfeilmeldinger,skjema,validerAlleSynligeFelter,valideringErOk:()=>0===alleSynligeFelter().filter(felt=>felt.valideringsstatus!==Valideringsstatus.OK).length&&skjema.submitRessurs.status!==dist.WG.HENTER}},ok=felt=>({...felt,feilmelding:"",valideringsstatus:Valideringsstatus.OK}),feil=(felt,feilmelding)=>({...felt,feilmelding,valideringsstatus:Valideringsstatus.FEIL});var esm=__webpack_require__("./node_modules/@navikt/ds-react/esm/index.js");const skjema_stories={parameters:{docs:{subtitle:"Skjemaeksempel for team familie."},text:"Test"},title:"hooks/skjema"},SkjemaTyper={ORDINÆR:"Ordinær",UTVIDET:"Utvidet",EØS:"EØS"},EnkeltSkjema=()=>{const[eksempelMelding,settEksempelMelding]=(0,react.useState)(""),navn=useFelt({verdi:"",valideringsfunksjon:felt=>felt.verdi.length>=1?ok(felt):feil(felt,"Du må sette navn")}),land=useFelt({verdi:"",valideringsfunksjon:felt=>felt.verdi?ok(felt):feil(felt,"Du må sette land")}),by=useFelt({verdi:"",valideringsfunksjon:(felt,avhengigheter)=>{const{land}=avhengigheter;return felt.verdi?"Norge"===land.verdi?"Oslo"===felt.verdi?ok(felt):feil(felt,"Du kan kun velge Oslo når Norge er valgt som land"):ok(felt):feil(felt,"Du må sette by")},skalFeltetVises:avhengigheter=>{const{land}=avhengigheter;return""!==land.verdi},avhengigheter:{land}}),skjemaType=useFelt({verdi:void 0,valideringsfunksjon:felt=>felt.verdi&&felt.verdi in SkjemaTyper?ok(felt):feil(felt,"Du må velge blant disse")}),{kanSendeSkjema,nullstillSkjema,hentFeilTilOppsummering,skjema}=useSkjema({felter:{navn,land,by},skjemanavn:"enkelt-skjema"});return console.log(skjema),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.A_,{...skjema.felter.navn.hentNavInputProps(skjema.visFeilmeldinger),label:"Navn",style:{width:"max-content"}}),(0,jsx_runtime.jsx)(esm.A_,{...skjema.felter.land.hentNavInputProps(skjema.visFeilmeldinger),label:"Land",style:{width:"max-content"}}),skjema.felter.by.erSynlig&&(0,jsx_runtime.jsx)(esm.A_,{...skjema.felter.by.hentNavInputProps(skjema.visFeilmeldinger),label:"By (kun Oslo når Norge er valgt som land)",style:{width:"max-content"}}),(0,jsx_runtime.jsx)("p",{children:eksempelMelding}),(0,jsx_runtime.jsxs)(esm.l6,{...skjemaType.hentNavInputProps(!1),label:"Hva søker du om?",style:{width:"max-content"},children:[(0,jsx_runtime.jsx)("option",{value:void 0,label:"Velg søknadstype",disabled:!0,selected:!0}),Object.entries(SkjemaTyper).map(entry=>{const[verdi,label]=entry;return(0,jsx_runtime.jsx)("option",{value:verdi,children:label},verdi)})]}),skjemaType.verdi&&(0,jsx_runtime.jsxs)("p",{children:["Du har valgt: ",skjemaType.verdi]}),skjema.visFeilmeldinger&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)(esm.dF,{size:"small",heading:"Du må rette følgende for å gå videre:",children:hentFeilTilOppsummering().map((feilTilOppsummering,index)=>(0,jsx_runtime.jsx)(esm.dF.Item,{href:`#${feilTilOppsummering.skjemaelementId}`,children:feilTilOppsummering.feilmelding},index))}),(0,jsx_runtime.jsx)("br",{})]}),(0,jsx_runtime.jsx)(esm.$n,{onClick:()=>{console.log(skjema),kanSendeSkjema()?(settEksempelMelding("Skjema sendt inn"),nullstillSkjema()):settEksempelMelding("Eksempelet har feil!")},loading:skjema.submitRessurs.status===dist.WG.HENTER,children:"Send inn"})]})},__namedExportsOrder=["EnkeltSkjema"];EnkeltSkjema.parameters={...EnkeltSkjema.parameters,docs:{...EnkeltSkjema.parameters?.docs,source:{originalSource:"() => {\n  const [eksempelMelding, settEksempelMelding] = useState('');\n  const navn = useFelt<string>({\n    verdi: '',\n    valideringsfunksjon: (felt: FeltState<string>) => felt.verdi.length >= 1 ? ok(felt) : feil(felt, 'Du må sette navn')\n  });\n  const land = useFelt<string>({\n    verdi: '',\n    valideringsfunksjon: (felt: FeltState<string>) => felt.verdi ? ok(felt) : feil(felt, 'Du må sette land')\n  });\n  const by = useFelt<string>({\n    verdi: '',\n    valideringsfunksjon: (felt: FeltState<string>, avhengigheter: Avhengigheter) => {\n      const {\n        land\n      } = avhengigheter;\n      if (!felt.verdi) {\n        return feil(felt, 'Du må sette by');\n      }\n      if (land.verdi === 'Norge') {\n        return felt.verdi === 'Oslo' ? ok(felt) : feil(felt, 'Du kan kun velge Oslo når Norge er valgt som land');\n      }\n      return ok(felt);\n    },\n    skalFeltetVises: (avhengigheter: Avhengigheter) => {\n      const {\n        land\n      } = avhengigheter;\n      return land.verdi !== '' ? true : false;\n    },\n    avhengigheter: {\n      land\n    }\n  });\n  const skjemaType = useFelt<string | undefined>({\n    verdi: undefined,\n    valideringsfunksjon: (felt: FeltState<string | undefined>) => felt.verdi && felt.verdi in SkjemaTyper ? ok(felt) : feil(felt, 'Du må velge blant disse')\n  });\n  const {\n    kanSendeSkjema,\n    nullstillSkjema,\n    hentFeilTilOppsummering,\n    skjema\n  } = useSkjema<{\n    navn: string;\n    land: string;\n    by: string;\n  }, string>({\n    felter: {\n      navn,\n      land,\n      by\n    },\n    skjemanavn: 'enkelt-skjema'\n  });\n  console.log(skjema);\n  return <>\n            <TextField {...skjema.felter.navn.hentNavInputProps(skjema.visFeilmeldinger)} label={'Navn'} style={{\n      width: 'max-content'\n    }} />\n\n            <TextField {...skjema.felter.land.hentNavInputProps(skjema.visFeilmeldinger)} label={'Land'} style={{\n      width: 'max-content'\n    }} />\n\n            {skjema.felter.by.erSynlig && <TextField {...skjema.felter.by.hentNavInputProps(skjema.visFeilmeldinger)} label={'By (kun Oslo når Norge er valgt som land)'} style={{\n      width: 'max-content'\n    }} />}\n\n            <p>{eksempelMelding}</p>\n\n            <Select {...skjemaType.hentNavInputProps(false)} label={'Hva søker du om?'} style={{\n      width: 'max-content'\n    }}>\n                <option value={undefined} label={'Velg søknadstype'} disabled={true} selected={true} />\n                {Object.entries(SkjemaTyper).map(entry => {\n        const [verdi, label] = entry;\n        return <option key={verdi} value={verdi}>\n                            {label}\n                        </option>;\n      })}\n            </Select>\n            {skjemaType.verdi && <p>Du har valgt: {skjemaType.verdi}</p>}\n\n            {skjema.visFeilmeldinger && <>\n                    <br />\n                    <ErrorSummary size={'small'} heading={'Du må rette følgende for å gå videre:'}>\n                        {hentFeilTilOppsummering().map((feilTilOppsummering, index) => {\n          return <ErrorSummary.Item key={index} href={`#${feilTilOppsummering.skjemaelementId}`}>\n                                    {feilTilOppsummering.feilmelding}\n                                </ErrorSummary.Item>;\n        })}\n                    </ErrorSummary>\n                    <br />\n                </>}\n\n            <Button onClick={() => {\n      console.log(skjema);\n      if (kanSendeSkjema()) {\n        // Kall onSubmit på riktig endepunkt\n        settEksempelMelding('Skjema sendt inn');\n        nullstillSkjema();\n      } else {\n        settEksempelMelding('Eksempelet har feil!');\n      }\n    }} loading={skjema.submitRessurs.status === RessursStatus.HENTER}>\n                Send inn\n            </Button>\n        </>;\n}",...EnkeltSkjema.parameters?.docs?.source}}}},"./packages/familie-typer/dist/index.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var AdresseType,FamilieRelasjonRolle,kjønnType,Adressebeskyttelsegradering;__webpack_require__.d(__webpack_exports__,{qn:()=>Adressebeskyttelsegradering,WG:()=>RessursStatus,eq:()=>adressebeskyttelsestyper,lN:()=>byggDataRessurs,oV:()=>byggFunksjonellFeilRessurs,bb:()=>byggHenterRessurs,Nh:()=>byggTomRessurs,yI:()=>kjønnType}),function(AdresseType){AdresseType.BOSTEDSADRESSE="BOSTEDSADRESSE",AdresseType.MIDLERTIDIG_POSTADRESSE_NORGE="MIDLERTIDIG_POSTADRESSE_NORGE",AdresseType.MIDLERTIDIG_POSTADRESSE_UTLAND="MIDLERTIDIG_POSTADRESSE_UTLAND",AdresseType.POSTADRESSE="POSTADRESSE",AdresseType.POSTADRESSE_UTLAND="POSTADRESSE_UTLAND",AdresseType.UKJENT_ADRESSE="UKJENT_ADRESSE"}(AdresseType||(AdresseType={})),function(FamilieRelasjonRolle){FamilieRelasjonRolle.BARN="BARN",FamilieRelasjonRolle.FAR="FAR",FamilieRelasjonRolle.MEDMOR="MEDMOR",FamilieRelasjonRolle.MOR="MOR",FamilieRelasjonRolle.EKTE="EKTE"}(FamilieRelasjonRolle||(FamilieRelasjonRolle={})),function(kjønnType){kjønnType.KVINNE="KVINNE",kjønnType.MANN="MANN",kjønnType.UKJENT="UKJENT"}(kjønnType||(kjønnType={})),function(Adressebeskyttelsegradering){Adressebeskyttelsegradering.STRENGT_FORTROLIG="STRENGT_FORTROLIG",Adressebeskyttelsegradering.STRENGT_FORTROLIG_UTLAND="STRENGT_FORTROLIG_UTLAND",Adressebeskyttelsegradering.FORTROLIG="FORTROLIG",Adressebeskyttelsegradering.UGRADERT="UGRADERT"}(Adressebeskyttelsegradering||(Adressebeskyttelsegradering={}));const adressebeskyttelsestyper={STRENGT_FORTROLIG:"strengt fortrolig",STRENGT_FORTROLIG_UTLAND:"strengt fortrolig utland",FORTROLIG:"fortrolig",UGRADERT:"ugradert"};var IdentGruppe,OppgavePrioritet,OppgaveStatus,RessursStatus;!function(IdentGruppe){IdentGruppe.AKTOERID="AKTOERID",IdentGruppe.FOLKEREGISTERIDENT="FOLKEREGISTERIDENT",IdentGruppe.NPID="NPID",IdentGruppe.ORGNR="ORGNR",IdentGruppe.SAMHANDLERNR="SAMHANDLERNR"}(IdentGruppe||(IdentGruppe={})),function(OppgavePrioritet){OppgavePrioritet.HOY="HOY",OppgavePrioritet.NORM="NORM",OppgavePrioritet.LAV="LAV"}(OppgavePrioritet||(OppgavePrioritet={})),function(OppgaveStatus){OppgaveStatus.OPPRETTET="OPPRETTET",OppgaveStatus.AAPNET="AAPNET",OppgaveStatus.UNDER_BEHANDLING="UNDER_BEHANDLING",OppgaveStatus.FERDIGSTILT="FERDIGSTILT",OppgaveStatus.FEILREGISTRERT="FEILREGISTRERT"}(OppgaveStatus||(OppgaveStatus={})),function(RessursStatus){RessursStatus.FEILET="FEILET",RessursStatus.FUNKSJONELL_FEIL="FUNKSJONELL_FEIL",RessursStatus.HENTER="HENTER",RessursStatus.IKKE_HENTET="IKKE_HENTET",RessursStatus.IKKE_TILGANG="IKKE_TILGANG",RessursStatus.SUKSESS="SUKSESS"}(RessursStatus||(RessursStatus={}));const byggTomRessurs=()=>({status:RessursStatus.IKKE_HENTET}),byggDataRessurs=data=>({status:RessursStatus.SUKSESS,data}),byggHenterRessurs=()=>({status:RessursStatus.HENTER}),byggFunksjonellFeilRessurs=frontendFeilmelding=>({frontendFeilmelding,status:RessursStatus.FUNKSJONELL_FEIL});var JournalpostDatotype,AvsenderMottakerIdType,Journalposttype,Journalstatus,Dokumentstatus;!function(JournalpostDatotype){JournalpostDatotype.DATO_SENDT_PRINT="DATO_SENDT_PRINT",JournalpostDatotype.DATO_EKSPEDERT="DATO_EKSPEDERT",JournalpostDatotype.DATO_JOURNALFOERT="DATO_JOURNALFOERT",JournalpostDatotype.DATO_REGISTRERT="DATO_REGISTRERT",JournalpostDatotype.DATO_AVS_RETUR="DATO_AVS_RETUR",JournalpostDatotype.DATO_DOKUMENT="DATO_DOKUMENT"}(JournalpostDatotype||(JournalpostDatotype={})),function(AvsenderMottakerIdType){AvsenderMottakerIdType.FNR="FNR",AvsenderMottakerIdType.HPRNR="HPRNR",AvsenderMottakerIdType.ORGNR="ORGNR",AvsenderMottakerIdType.UKJENT="UKJENT",AvsenderMottakerIdType.UTL_ORG="UTL_ORG"}(AvsenderMottakerIdType||(AvsenderMottakerIdType={})),function(Journalposttype){Journalposttype.I="I",Journalposttype.U="U",Journalposttype.N="N"}(Journalposttype||(Journalposttype={})),function(Journalstatus){Journalstatus.MOTTATT="MOTTATT",Journalstatus.JOURNALFOERT="JOURNALFOERT",Journalstatus.FERDIGSTILT="FERDIGSTILT",Journalstatus.EKSPEDERT="EKSPEDERT",Journalstatus.UNDER_ARBEID="UNDER_ARBEID",Journalstatus.FEILREGISTRERT="FEILREGISTRERT",Journalstatus.UTGAAR="UTGAAR",Journalstatus.AVBRUTT="AVBRUTT",Journalstatus.UKJENT_BRUKER="UKJENT_BRUKER",Journalstatus.RESERVERT="RESERVERT",Journalstatus.OPPLASTING_DOKUMENT="OPPLASTING_DOKUMENT",Journalstatus.UKJENT="UKJENT"}(Journalstatus||(Journalstatus={})),function(Dokumentstatus){Dokumentstatus.FERDIGSTILT="FERDIGSTILT",Dokumentstatus.AVBRUTT="AVBRUTT",Dokumentstatus.UNDER_REDIGERING="UNDER_REDIGERING",Dokumentstatus.KASSERT="KASSERT"}(Dokumentstatus||(Dokumentstatus={}))},"?b1b0"(){}}]);